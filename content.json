{"meta":{"title":"Crane's Blog","subtitle":"","description":"","author":"mhp","url":"http://yoursite.com","root":"/"},"pages":[{"title":"Repositories","date":"2020-06-22T02:52:10.751Z","updated":"2020-06-20T14:49:56.983Z","comments":false,"path":"repository/index.html","permalink":"http://yoursite.com/repository/index.html","excerpt":"","text":""},{"title":"关于","date":"2020-06-20T14:49:56.980Z","updated":"2020-06-20T14:49:56.980Z","comments":false,"path":"about/index.html","permalink":"http://yoursite.com/about/index.html","excerpt":"","text":"个人详细介绍"},{"title":"分类","date":"2020-06-20T14:49:56.981Z","updated":"2020-06-20T14:49:56.981Z","comments":false,"path":"categories/index.html","permalink":"http://yoursite.com/categories/index.html","excerpt":"","text":""},{"title":"标签","date":"2020-06-20T14:49:56.983Z","updated":"2020-06-20T14:49:56.983Z","comments":false,"path":"tags/index.html","permalink":"http://yoursite.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"v2ray+nginx科学上网教程","slug":"v2ray-nginx科学上网教程","date":"2020-06-20T14:01:17.000Z","updated":"2020-06-22T02:59:57.180Z","comments":true,"path":"2020/06/20/v2ray-nginx科学上网教程/","link":"","permalink":"http://yoursite.com/2020/06/20/v2ray-nginx%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E6%95%99%E7%A8%8B/","excerpt":"","text":"00x1首先要有一台国外VPS和一个域名。vps开启80,443端口，域名正确解析到服务器。 00x2 安装nginx登录服务器，这里以系统Ubuntu16.04为例。 更新apt sudo apt-get update 安装nginx sudo apt-get install nginx 到/etc/nginx/conf.d/目录下，新建v2ray.conf文件，并输入以下内容。“你的域名”处填写域名。 1234567891011121314151617181920212223242526server &#123; listen 80; root &#x2F;var&#x2F;www&#x2F;html&#x2F;; index index.html index.htm; server_name 你的域名; rewrite ^(.*)$ https:&#x2F;&#x2F;$host$1 permanent; &#125;server &#123; listen 443 ssl; root &#x2F;var&#x2F;www&#x2F;html&#x2F;; index index.html index.htm; server_name 你的域名; ssl_certificate ; ssl_certificate_key ; ssl_protocols TLSv1.2; ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4:!DH:!DHE; location &#x2F;abc &#123; proxy_redirect off; proxy_pass http:&#x2F;&#x2F;127.0.0.1:60001; proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection &quot;upgrade&quot;; proxy_set_header Host $http_host; access_log off; &#125;&#125; 00x3 安装BBR加速内核BBR是Google推出的一套拥塞控制算法，集成在最新的Linux内核中。BBR应用在VPS服务器上，可以明显改善服务器的网络传输速度，减少丢包。 一键脚本安装 1wget --no-check-certificate -O tcp.sh https:&#x2F;&#x2F;github.com&#x2F;cx9208&#x2F;Linux-NetSpeed&#x2F;raw&#x2F;master&#x2F;tcp.sh &amp;&amp; chmod +x tcp.sh &amp;&amp; .&#x2F;tcp.sh 运行tcp.sh首先选择2，安装BBRplus版内核，Ubuntu16.04自带内核版本不支持bbr所以先要升级。一键安装内核并重启之后，再运行脚本则会显示当前状态：已安装BBRplus。然后再选择7，使用BBRplus版加速。会显示BBRplus启动成功。 可用 lsmod | grep bbr 命令验证是否启动成功。如果有连接数，即启动成功 00x4 安装v2ray一键脚本安装 bash &lt;(curl -s -L https://install.direct/go.sh) 修改配置文件 /etc/v2ray/config.json，修改为以下内容。其中id参数可由客户端生成，也可用网上其他方式生成，只要服务端和客户端保持一致即可。 1234567891011121314151617181920212223242526272829303132333435363738&#123; &quot;log&quot; : &#123; &quot;access&quot;: &quot;&#x2F;var&#x2F;log&#x2F;v2ray&#x2F;access.log&quot;, &quot;error&quot;: &quot;&#x2F;var&#x2F;log&#x2F;v2ray&#x2F;error.log&quot;, &quot;loglevel&quot;: &quot;warning&quot; &#125;, &quot;inbound&quot;: &#123; &quot;port&quot;: 60001, &#x2F;&#x2F;(此端口与nginx配置相关) &quot;listen&quot;: &quot;127.0.0.1&quot;, &quot;protocol&quot;: &quot;vmess&quot;, &quot;settings&quot;: &#123; &quot;clients&quot;: [ &#123; &quot;id&quot;: &quot;xxxx&quot;, &quot;level&quot;: 1, &quot;alterId&quot;: 64 一致 &#125; ] &#125;, &quot;streamSettings&quot;:&#123; &quot;network&quot;: &quot;ws&quot;, &quot;wsSettings&quot;: &#123; &quot;path&quot;: &quot;&#x2F;abc&quot; &#125; &#125; &#125;, &quot;outbound&quot;: &#123; &quot;protocol&quot;: &quot;freedom&quot;, &quot;settings&quot;: &#123;&#125; &#125;, &quot;outboundDetour&quot;: [ &#123; &quot;protocol&quot;: &quot;blackhole&quot;, &quot;settings&quot;: &#123;&#125;, &quot;tag&quot;: &quot;blocked&quot; &#125; ]&#125; 保存之后之后重启v2ray。 service v2ray restart 00x5 安装ssl证书安装之前先把nginx服务停掉。service nginx stop 新建一个文件夹，并下载安装脚本 1234mkdir certautocd &#x2F;certautowget https:&#x2F;&#x2F;dl.eff.org&#x2F;certbot-autochmod +x .&#x2F;certbot-auto 执行安装命令，邮箱和域名填写自己的。 1.&#x2F;certbot-auto certonly --email XXX@163.com -d www.xxx.cn 安装过程，这里选2，启动一个临时web服务器 后面的就选同意 没问题就会显示安装成功。有问题可能是端口占用问题，起临时web服务器需要使用80端口。 图中两个pem文件就是证书文件，把完整链接复制到/etc/nginx/conf.d/v2ray.conf文件中如图位置。保存文件。 重启nginx和v2ray，然后再去访问你的域名，看到如下页面证明前面的都安装成功。 00x6 客户端配置客户端下载：https://github.com/2dust/v2rayN/releases 客户端配置：选择，服务器-&gt;添加VMess服务器。地址填写域名、用户id可以自动生成，并将id填写到/etc/v2ray/config.json文件id参数处、额外id填64、传输协议选ws、路径填/abc，与v2ray.conf文件中location处参数一致即可、其他的可照图片配置。点确定后即可自动启动。如果配置都没问题即可在信息处看到访问记录信息。","categories":[{"name":"教程","slug":"教程","permalink":"http://yoursite.com/categories/%E6%95%99%E7%A8%8B/"}],"tags":[{"name":"科学上网","slug":"科学上网","permalink":"http://yoursite.com/tags/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/"}]}],"categories":[{"name":"教程","slug":"教程","permalink":"http://yoursite.com/categories/%E6%95%99%E7%A8%8B/"}],"tags":[{"name":"科学上网","slug":"科学上网","permalink":"http://yoursite.com/tags/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/"}]}